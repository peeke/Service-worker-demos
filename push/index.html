<!DOCTYPE html>
<html lang="en" data-module="Main">
<head>

    <meta charset="UTF-8">
    <title>Service Worker Demos: Push</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="/main.css">
    <link href="https://fonts.googleapis.com/css?family=Playfair+Display:900|Lato:300,400,700" rel="stylesheet" type='text/css'>

    <script>

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/push/push.js', { scope: '/push/' });
        }

    </script>

    <script src="subscribe.js" type="text/javascript"></script>

</head>
<body>

<header class="l-restrain">
    <p class="site-title"><span>Service Worker Demos</span></p>
</header>

<main>

    <article data-cms-id='{{ id }}' data-cms-type='{{ type }}' class='c-article l-restrain'>

        <h1 class="title">Push</h1>

        <code>// Subscription</code>

        <code id="response"></code>

        <pre>
<code>
// Server side

const webpush = require('web-push');

webpush.sendNotification(subscription.endpoint, {
    TTL: 120,
    userPublicKey: subscription.keys.p256dh,
    userAuth: subscription.keys.auth,
    payload: JSON.stringify(publication)
});
</code>
        </pre>

    </article>

</main>

</body>
</html>